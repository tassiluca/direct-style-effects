<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{appearance:none;background-color:initial;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTAgMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJtMzIgOTAgNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgeD0iMTAiIHk9IjIwIiBjbGFzcz0iYSIgcng9IjUuNjciLz48cGF0aCBkPSJNNDAgNzBIMjBWNTBtMjAgMEwyMCA3MG00MC00MGgyMHYyMG0tMjAgMCAyMC0yMCIgY2xhc3M9ImEiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgeD0iMTAiIHk9IjIwIiBjbGFzcz0iYSIgcng9IjUuNjciLz48cGF0aCBkPSJNMjAgNTBoMjB2MjBtLTIwIDAgMjAtMjBtNDAgMEg2MFYzMG0yMCAwTDYwIDUwIiBjbGFzcz0iYSIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNODcuOCA0Ny41Qzg5IDUwIDg3LjcgNTIgODUgNTJIMzVhOC43IDguNyAwIDAgMS03LjItNC41bC0xNS42LTMxQzExIDE0IDEyLjIgMTIgMTUgMTJoNTBhOC44IDguOCAwIDAgMSA3LjIgNC41ek02MCA1MnYzNm0tMTAgMGgyME00NSA0MmgyMCIvPjwvc3ZnPg==") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-bigger{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMTIgNTBoODBNNTIgOTBWMTAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-smaller{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMTIgNTBoODAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}}@keyframes __bespoke_marp_transition_reduced_outgoing__{0%{opacity:1}to{opacity:0}}@keyframes __bespoke_marp_transition_reduced_incoming__{0%{mix-blend-mode:plus-lighter;opacity:0}to{mix-blend-mode:plus-lighter;opacity:1}}.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{::view-transition-group(*){animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-timing-function:ease}::view-transition-new(*),::view-transition-old(*){animation-delay:0s;animation-direction:var(--marp-bespoke-transition-animation-direction,normal);animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-fill-mode:both;animation-name:var(--marp-bespoke-transition-animation-name,var(--marp-bespoke-transition-animation-name-fallback,__bespoke_marp_transition_no_animation__));mix-blend-mode:normal}::view-transition-old(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_outgoing__;animation-timing-function:ease}::view-transition-new(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_incoming__;animation-timing-function:ease}::view-transition-new(root),::view-transition-old(root){animation-timing-function:linear}::view-transition-new(__bespoke_marp_transition_osc__),::view-transition-old(__bespoke_marp_transition_osc__){animation-duration:0s!important;animation-name:__bespoke_marp_transition_osc__!important}::view-transition-new(__bespoke_marp_transition_osc__){opacity:0!important}.bespoke-marp-transition-warming-up::view-transition-group(*),.bespoke-marp-transition-warming-up::view-transition-new(*),.bespoke-marp-transition-warming-up::view-transition-old(*){animation-play-state:paused!important}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide:not(.bespoke-marp-active) *{view-transition-name:none!important}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}}@media screen and (prefers-reduced-motion:reduce){svg.bespoke-marp-slide *{view-transition-name:none!important}}@media screen{[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{inset:0;position:absolute}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:#000000a6;border-radius:7px;bottom:50px;color:#fff;contain:paint;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;user-select:none;white-space:nowrap;will-change:transform;z-index:1;view-transition-name:__bespoke_marp_transition_osc__}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{background:#0288d1;flex:0 0 0;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:#0000}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{display:grid;font-family:Helvetica,Arial,sans-serif;grid-template:"current dragbar next" minmax(140px,1fr) "current dragbar note" 2fr "info    dragbar note" 3em;grid-template-columns:minmax(3px,var(--bespoke-marp-presenter-split-ratio,66%)) 0 minmax(3px,1fr);height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container{background:#0288d1;cursor:col-resize;grid-area:dragbar;margin-left:-3px;opacity:0;position:relative;transition:opacity .4s linear .1s;width:6px;z-index:10}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container:hover{opacity:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container.active{opacity:1;transition-delay:0s}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:#0000;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note;position:relative;z-index:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper{display:block;inset:0;position:absolute}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons{background:#000000a6;border-radius:4px;bottom:0;display:flex;gap:4px;margin:12px;opacity:0;padding:6px;pointer-events:none;position:absolute;right:0;transition:opacity .2s linear}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons:focus-within,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper:focus-within+.bespoke-marp-presenter-note-buttons,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container:hover .bespoke-marp-presenter-note-buttons{opacity:1;pointer-events:auto}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{box-sizing:border-box;font-size:calc(1.1em*var(--bespoke-marp-note-font-scale, 1));height:calc(100% - 40px);margin:20px;overflow:auto;padding-right:3px;white-space:pre-wrap;width:calc(100% - 40px);word-wrap:break-word;scrollbar-color:#eeeeee80 #0000;scrollbar-width:thin}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:#0000}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:#eeeeee80;border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;overflow:hidden;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{box-sizing:border-box;display:block;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer:hover{cursor:pointer}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>div#\:\$p > svg > foreignObject > section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center;-webkit-text-size-adjust:100%;text-size-adjust:100%}div#\:\$p > svg > foreignObject > section::after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#\:\$p > svg > foreignObject > section:not([data-marpit-pagination])::after{display:none}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){font-size:2em;margin:0.67em 0}div#\:\$p > svg > foreignObject > section video::-webkit-media-controls{will-change:transform}@page {size:1280px 720px;margin:0}@media print{html, body{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#\:\$p > svg > foreignObject > section{page-break-before:always;break-before:page}div#\:\$p > svg > foreignObject > section, div#\:\$p > svg > foreignObject > section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#\:\$p > svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#\:\$p > svg > foreignObject > :where(section){container-type:size}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"]{direction:ltr}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"] > svg{overflow:visible;min-height:1px;min-width:1px}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"] > svg a{fill:blue;stroke:blue}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"][display="true"]{display:block;text-align:center;margin:1em 0}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"][display="true"][width="full"]{display:flex}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"][justify="left"]{text-align:left}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"][justify="right"]{text-align:right}div#\:\$p > svg > foreignObject > section g[data-mml-node="merror"] > g{fill:red;stroke:red}div#\:\$p > svg > foreignObject > section g[data-mml-node="merror"] > rect[data-background]{fill:yellow;stroke:none}div#\:\$p > svg > foreignObject > section g[data-mml-node="mtable"] > line[data-line], div#\:\$p > svg > foreignObject > section svg[data-table] > g > line[data-line]{stroke-width:70px;fill:none}div#\:\$p > svg > foreignObject > section g[data-mml-node="mtable"] > rect[data-frame], div#\:\$p > svg > foreignObject > section svg[data-table] > g > rect[data-frame]{stroke-width:70px;fill:none}div#\:\$p > svg > foreignObject > section g[data-mml-node="mtable"] > .mjx-dashed, div#\:\$p > svg > foreignObject > section svg[data-table] > g > .mjx-dashed{stroke-dasharray:140}div#\:\$p > svg > foreignObject > section g[data-mml-node="mtable"] > .mjx-dotted, div#\:\$p > svg > foreignObject > section svg[data-table] > g > .mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}div#\:\$p > svg > foreignObject > section g[data-mml-node="mtable"] > g > svg{overflow:visible}div#\:\$p > svg > foreignObject > section [jax="SVG"] mjx-tool{display:inline-block;position:relative;width:0;height:0}div#\:\$p > svg > foreignObject > section [jax="SVG"] mjx-tool > mjx-tip{position:absolute;top:0;left:0}div#\:\$p > svg > foreignObject > section mjx-tool > mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#F8F8F8;color:black;box-shadow:2px 2px 5px #AAAAAA}div#\:\$p > svg > foreignObject > section g[data-mml-node="maction"][data-toggle]{cursor:pointer}div#\:\$p > svg > foreignObject > section mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#F8F8F8;color:black}div#\:\$p > svg > foreignObject > section foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"] path[data-c], div#\:\$p > svg > foreignObject > section mjx-container[jax="SVG"] use[data-c]{stroke-width:3}@media print{div#\:\$p > svg > foreignObject > section mjx-container[jax=SVG] path[data-c],div#\:\$p > svg > foreignObject > section mjx-container[jax=SVG] use[data-c]{stroke-width:0}}div#\:\$p > svg > foreignObject > section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}/*!
 * Marp / Marpit Uncover theme
 *
 * @theme uncover
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 16:9 1280px 720px
 * @size 4:3 960px 720px
 */div#\:\$p > svg > foreignObject > section{--color-background:#fdfcff;--color-background-code:#f2f1f4;--color-background-paginate:rgba(32,34,40,.05);--color-foreground:#202228;--color-highlight:#009dd5;--color-highlight-hover:#087eaa;--color-highlight-heading:#33b1dd;--color-header:rgba(32,34,40,.4);--color-header-shadow:rgba(253,252,255,.8);background:var(--color-background);color:var(--color-foreground);display:block;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:40px;height:720px;letter-spacing:3px;line-height:1.4;padding:30px 70px;place-content:safe center center;position:relative;text-align:center;width:1280px;word-wrap:break-word;align-items:stretch;flex-flow:column nowrap;z-index:0}div#\:\$p > svg > foreignObject > section{--marpit-root-font-size:40px;}div#\:\$p > svg > foreignObject > section:after{align-items:flex-end;background:linear-gradient(-45deg, var(--color-background-paginate) 50%, transparent 50%);background-size:cover;color:var(--color-foreground);display:flex;font-size:.6em;height:80px;justify-content:flex-end;padding:30px;text-align:right;text-shadow:0 0 5px var(--color-background);width:80px}div#\:\$p > svg > foreignObject > section:after{--marpit-root-font-size:.6em;}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) :is(pre, marp-pre) code.hljs{display:block;overflow-x:auto;padding:1em}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) code.hljs{padding:3px 5px}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs{background:#fff;color:#000}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-addition,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-meta,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-string,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-symbol,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-template-tag,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-template-variable{color:#756bb1}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-comment,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-quote{color:#636363}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-bullet,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-link,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-literal,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-number,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-regexp{color:#31a354}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-deletion,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-variable{color:#88f}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-built_in,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-doctag,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-keyword,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-name,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-section,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-selector-class,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-selector-id,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-selector-tag,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-strong,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-tag,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-title,div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-type{color:#3182bd}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-emphasis{font-style:italic}div#\:\$p > svg > foreignObject > section:where(:not(.invert)) .hljs-attribute{color:#e6550d}div#\:\$p > svg > foreignObject > section:where(.invert){--color-background:#202228;--color-background-code:#2b2d33;--color-background-paginate:hsla(0,0%,100%,.05);--color-foreground:#fff;--color-highlight:#60d0f0;--color-highlight-hover:#88dcf4;--color-highlight-heading:#80d9f3;--color-header:hsla(0,0%,100%,.4);--color-header-shadow:rgba(32,34,40,.8);}div#\:\$p > svg > foreignObject > section:where(.invert) :is(pre, marp-pre) code.hljs{display:block;overflow-x:auto;padding:1em}div#\:\$p > svg > foreignObject > section:where(.invert) code.hljs{padding:3px 5px}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs{background:#222;color:#fff}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-comment,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-quote{color:#777}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-built_in,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-bullet,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-deletion,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-link,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-literal,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-meta,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-number,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-params,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-regexp,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-symbol,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-tag,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-template-variable,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-variable{color:#ab875d}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-attribute,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-name,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-section,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-selector-class,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-selector-id,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-title,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-type{color:#9b869b}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-addition,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-keyword,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-selector-tag,div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-string{color:#8f9c6c}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-emphasis{font-style:italic}div#\:\$p > svg > foreignObject > section:where(.invert) .hljs-strong{font-weight:700}div#\:\$p > svg > foreignObject > section>:first-child,div#\:\$p > svg > foreignObject > section[data-header]>:nth-child(2){margin-top:0}div#\:\$p > svg > foreignObject > section>:last-child,div#\:\$p > svg > foreignObject > section[data-footer]>:nth-last-child(2){margin-bottom:0}div#\:\$p > svg > foreignObject > section blockquote,div#\:\$p > svg > foreignObject > section p{margin:0 0 15px}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section :is(h2, marp-h2),div#\:\$p > svg > foreignObject > section :is(h3, marp-h3),div#\:\$p > svg > foreignObject > section :is(h4, marp-h4),div#\:\$p > svg > foreignObject > section :is(h5, marp-h5),div#\:\$p > svg > foreignObject > section :is(h6, marp-h6){margin:15px 0 30px}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) strong,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2) strong,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3) strong,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4) strong,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5) strong,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6) strong{color:var(--color-highlight-heading);font-weight:inherit}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h2, marp-h2)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h3, marp-h3)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h4, marp-h4)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h5, marp-h5)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h6, marp-h6)::part(auto-scaling){max-height:660px}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){font-size:2em}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){font-size:1.7em}div#\:\$p > svg > foreignObject > section :is(h3, marp-h3){font-size:1.4em;letter-spacing:2px}div#\:\$p > svg > foreignObject > section :is(h4, marp-h4){font-size:1.2em;letter-spacing:2px}div#\:\$p > svg > foreignObject > section :is(h5, marp-h5){font-size:1em;letter-spacing:1px}div#\:\$p > svg > foreignObject > section :is(h6, marp-h6){font-size:.8em;letter-spacing:1px}div#\:\$p > svg > foreignObject > section footer,div#\:\$p > svg > foreignObject > section header{color:var(--color-header);font-size:.45em;left:70px;letter-spacing:1px;position:absolute;right:70px;text-shadow:0 1px 0 var(--color-header-shadow);z-index:1}div#\:\$p > svg > foreignObject > section header{top:30px}div#\:\$p > svg > foreignObject > section footer{bottom:30px}div#\:\$p > svg > foreignObject > section a{color:var(--color-highlight);text-decoration:none}div#\:\$p > svg > foreignObject > section a:hover{color:var(--color-highlight-hover);text-decoration:underline}div#\:\$p > svg > foreignObject > section ol,div#\:\$p > svg > foreignObject > section ul{margin:0 auto;text-align:left}div#\:\$p > svg > foreignObject > section>ol,div#\:\$p > svg > foreignObject > section>ul{margin-bottom:15px}div#\:\$p > svg > foreignObject > section code{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;letter-spacing:0}div#\:\$p > svg > foreignObject > section :not(:is(pre, marp-pre))>code,div#\:\$p > svg > foreignObject > section>code{background:var(--color-background-code);color:var(--color-foreground);margin:-.2em .2em .2em;padding:.2em}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre){--preserve-aspect-ratio:xMidYMid meet;filter:drop-shadow(0 4px 4px rgba(0, 0, 0, .2));font-size:70%;line-height:1.15;margin:15px 0 30px;text-align:left}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre)::part(auto-scaling){max-height:570px}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre)>code{background:var(--color-background-code);box-sizing:content-box;color:var(--color-foreground);display:block;margin:0 auto;min-width:456px;padding:.4em .6em}div#\:\$p > svg > foreignObject > section[data-size="4:3"] :is(pre, marp-pre)>code{min-width:328px}div#\:\$p > svg > foreignObject > section table{border-collapse:collapse;margin:0 auto 15px}div#\:\$p > svg > foreignObject > section table>tbody>tr>td,div#\:\$p > svg > foreignObject > section table>tbody>tr>th,div#\:\$p > svg > foreignObject > section table>thead>tr>td,div#\:\$p > svg > foreignObject > section table>thead>tr>th{padding:.15em .5em}div#\:\$p > svg > foreignObject > section table>thead>tr>td,div#\:\$p > svg > foreignObject > section table>thead>tr>th{border-bottom:3px solid}div#\:\$p > svg > foreignObject > section table>tbody>tr:not(:last-child)>td,div#\:\$p > svg > foreignObject > section table>tbody>tr:not(:last-child)>th{border-bottom:1px solid}div#\:\$p > svg > foreignObject > section blockquote{font-size:90%;line-height:1.3;padding:0 2em;position:relative;z-index:0}div#\:\$p > svg > foreignObject > section blockquote:after,div#\:\$p > svg > foreignObject > section blockquote:before{content:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNNDQgMTkuMyAzOC45NCAwQzguMTQgOS41OSAwIDQwLjA1IDAgNTQuODNWMTAwaDQxLjQ3VjU0LjgzaC0yM2MtLjA0LS4yOC4yNS0yNy42NiAyNS41My0zNS41M201NiAwTDk0Ljk0IDBDNjQuMTQgOS41OSA1NiA0MC4wNSA1NiA1NC44M1YxMDBoNDEuNDdWNTQuODNoLTIzYy0uMDQtLjI4LjI1LTI3LjY2IDI1LjUzLTM1LjUzIiBzdHlsZT0iZmlsbDojODg4O29wYWNpdHk6LjMzIi8+PC9zdmc+");height:auto;pointer-events:none;position:absolute;width:1em;z-index:-1}div#\:\$p > svg > foreignObject > section blockquote:before{left:0;top:0}div#\:\$p > svg > foreignObject > section blockquote:after{bottom:0;right:0;transform:rotate(180deg)}div#\:\$p > svg > foreignObject > section blockquote>:last-child{margin-bottom:0}div#\:\$p > svg > foreignObject > section mark{background:transparent;color:var(--color-highlight)}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){font-size:calc(var(--marpit-root-font-size, 1rem) * 1.6)}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){font-size:calc(var(--marpit-root-font-size, 1rem) * 1.3)}div#\:\$p > svg > foreignObject > section :is(h3, marp-h3){font-size:calc(var(--marpit-root-font-size, 1rem) * 1.1);margin-bottom:0.2em}div#\:\$p > svg > foreignObject > section :is(h4, marp-h4){font-size:calc(var(--marpit-root-font-size, 1rem) * 0.9);margin-bottom:0.2em}div#\:\$p > svg > foreignObject > section p{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6);line-height:1.2;letter-spacing:0.02em}div#\:\$p > svg > foreignObject > section ul, div#\:\$p > svg > foreignObject > section ol{margin-left:1em}div#\:\$p > svg > foreignObject > section li{margin-bottom:0.5em;font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6);line-height:1.2;letter-spacing:0.02em}div#\:\$p > svg > foreignObject > section strong{color:#0366D6}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) em{color:#4fca6c}div#\:\$p > svg > foreignObject > section em{color:#36ab51}div#\:\$p > svg > foreignObject > section code{font-size:0.65em}div#\:\$p > svg > foreignObject > section a{color:#0366D6;text-decoration:none}div#\:\$p > svg > foreignObject > section .columns{display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));gap:calc(var(--marpit-root-font-size, 1rem) * 1);align-items:center}div#\:\$p > svg > foreignObject > section .columns img{width:100%;height:auto}div#\:\$p > svg > foreignObject > section .full-image{display:flex;justify-content:center;align-items:center;height:calc(100% - 50px)}div#\:\$p > svg > foreignObject > section .full-image img{max-width:90%;max-height:90%;object-fit:contain}div#\:\$p > svg > foreignObject > section .cols{display:flex;gap:16px}div#\:\$p > svg > foreignObject > section .cols > div{flex:1;padding:0 10px;border-right:1px solid #ccc}div#\:\$p > svg > foreignObject > section .cols > div:last-child{border-right:none}div#\:\$p > svg > foreignObject > section .smaller li, div#\:\$p > svg > foreignObject > section .smaller p, div#\:\$p > svg > foreignObject > section .smaller code, div#\:\$p > svg > foreignObject > section .smaller :is(pre, marp-pre){font-size:calc(var(--marpit-root-font-size, 1rem) * 0.5)!important}div#\:\$p > svg > foreignObject > section .center-list ul{list-style:none;padding:0;margin:0 auto;width:fit-content}div#\:\$p > svg > foreignObject > section .center-list li{text-align:center}div#\:\$p > svg > foreignObject > section table{font-size:calc(var(--marpit-root-font-size, 1rem) * 0.6);letter-spacing:0.02em;border-collapse:collapse;width:100%}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]{columns:initial!important;display:block!important;padding:0!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]::before, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]::after, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"]::before, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"]::after{display:none!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction="vertical"]{flex-direction:column}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"][data-marpit-advanced-background-split] > div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split, 50%)}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"][data-marpit-advanced-background-split="right"] > div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container] > figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container] > figure > figcaption{position:absolute;border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;white-space:nowrap;width:1px}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"], div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="pseudo"]{background:transparent!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="pseudo"], div#\:\$p > svg[data-marpit-svg] > foreignObject[data-marpit-advanced-background="pseudo"]{pointer-events:none!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background-split]{width:100%;height:100%}
</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id=":$p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-class="invert" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" class="invert" data-marpit-pagination="1" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--class:invert;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h1 id="direct-style-effect-management-in-scala-3"><em><strong>Direct Style</strong></em> <em>Effect Management</em> in Scala 3</h1>
<h2 id="taming-effects-with-capabilities">Taming effects with <strong>Capabilities</strong></h2>
<p>Luca Tassinari</p>
<div class="smaller">
<p>25/03/2025</p>
<p><a href="https://github.com/tassiluca/direct-style-effects"><em><ins>Link to code examples ↗</ins></em></a></p>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="2" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h2 id="what-direct-style-is">What <strong>Direct Style</strong> is?</h2>
<div class="cols">
<div>
<h4 id="monadic-style">Monadic Style</h4>
<p>The control flow is governed by <code>flatMap</code> operation.</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-keyword">for</span>
  user   &lt;- fetchUser(id)
  orders &lt;- fetchOrders(user)
  total  &lt;- calculateTotal(orders)
<span class="hljs-keyword">yield</span> total
</code></pre>
</div>
<div>
<h4 id="direct-style">Direct Style</h4>
<p>The control flow of the program is <em>explicit</em> and the program is written as a sequence of instructions that are executed one after the other, resembling imperative code, while still being in a <em>functional framework</em> (with all its benefits):</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-keyword">val</span> user   = fetchUser(id)
<span class="hljs-keyword">val</span> orders = fetchOrders(user)
<span class="hljs-keyword">val</span> total  = calculateTotal(orders)
total
</code></pre>
<p>Way easier to write and reason about!</p>
</div>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-marpit-fragments="2" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-class="invert" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" class="invert" data-marpit-pagination="3" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--class:invert;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21"><div class="center-list">
<h3 id="can-we-get-the-benefits-monads-give-us-in-terms-of-effect-management-using-direct-style-rather-than-monadic-style">Can we get the benefits Monads give us in terms of effect management using <em>Direct Style</em> rather than <em>Monadic Style</em>?</h3>
<ul>
<li data-marpit-fragment="1">
<h3 id="yes-we-will"><strong>Yes (we will*)!</strong></h3>
</li>
</ul>
<br />
<ul>
<li data-marpit-fragment="2">* some limitations are still being addressed</li>
</ul>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="4" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="boundary--break">Boundary &amp; Break</h3>
<p>Boundary &amp; break is a mechanism allowing to prematurely break the computation returning a value to the client. From Scala 3.2 onwards, non-local returns are no longer supported and <code>boundary</code> and <code>break</code> should be used instead.</p>
<p>Using non-local returns:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findFirstMatchingPair</span></span>[<span class="hljs-type">T</span>](list1: <span class="hljs-type">List</span>[<span class="hljs-type">T</span>], list2: <span class="hljs-type">List</span>[<span class="hljs-type">T</span>])(predicate: (<span class="hljs-type">T</span>, <span class="hljs-type">T</span>) =&gt; <span class="hljs-type">Boolean</span>): <span class="hljs-type">Option</span>[(<span class="hljs-type">T</span>, <span class="hljs-type">T</span>)] =
  <span class="hljs-keyword">for</span> i &lt;- list1 <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> j &lt;- list2 <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">if</span> predicate(i, j) <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-type">Some</span>((i, j))
  <span class="hljs-comment">//                          ~~~~~~~~~~~~~~~~~~~</span>
  <span class="hljs-comment">// Non local returns are no longer supported; use `boundary` and `boundary.break` in `scala.util` instead</span>
  <span class="hljs-type">None</span>
</code></pre>
<p>Using <code>boundary</code> and <code>break</code>:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findFirstMatchingPair</span></span>[<span class="hljs-type">T</span>](list1: <span class="hljs-type">List</span>[<span class="hljs-type">T</span>], list2: <span class="hljs-type">List</span>[<span class="hljs-type">T</span>])(predicate: (<span class="hljs-type">T</span>, <span class="hljs-type">T</span>) =&gt; <span class="hljs-type">Boolean</span>): <span class="hljs-type">Option</span>[(<span class="hljs-type">T</span>, <span class="hljs-type">T</span>)] =
  boundary:
    <span class="hljs-keyword">for</span> i &lt;- list1 <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">for</span> j &lt;- list2 <span class="hljs-keyword">do</span>
        <span class="hljs-keyword">if</span> predicate(i, j) <span class="hljs-keyword">then</span> <span class="hljs-keyword">break</span>(<span class="hljs-type">Some</span>((i, j)))
    <span class="hljs-type">None</span>
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="5" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="context-functions">Context Functions</h3>
<ul>
<li><code>break</code> is a method requiring a <code>Label[T]</code> context;</li>
<li><code>boundary</code> enriches the <code>body</code> with a <code>Label[T]</code> via a <strong>context function</strong>, i.e., a function of the form <br /> <code>(T1, ..., Tn) ?=&gt; E</code> where <code>T1, ..., Tn</code> instances are available as <em>givens</em> in <code>E</code>. Their values can be summoned or are available as a <em>contextual argument</em>:</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-keyword">package</span> scala.util

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">boundary</span></span>:

  <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span></span>[<span class="hljs-type">T</span>](<span class="hljs-keyword">inline</span> body: <span class="hljs-type">Label</span>[<span class="hljs-type">T</span>] ?=&gt; <span class="hljs-type">T</span>): <span class="hljs-type">T</span> = ...

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">break</span></span>[<span class="hljs-type">T</span>](value: <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> label: <span class="hljs-type">Label</span>[<span class="hljs-type">T</span>]): <span class="hljs-type">Nothing</span> = ...

<span class="hljs-comment">// Explicit desugared version using a contextual argument</span>
boundary: (label: <span class="hljs-type">Label</span>[<span class="hljs-type">Option</span>[(<span class="hljs-type">T</span>, <span class="hljs-type">T</span>)]]) ?=&gt;
  <span class="hljs-keyword">for</span> i &lt;- list1 <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> j &lt;- list2 <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">if</span> predicate(i, j) <span class="hljs-keyword">then</span> <span class="hljs-keyword">break</span>(<span class="hljs-type">Some</span>((i, j)))(<span class="hljs-keyword">using</span> label)
  <span class="hljs-type">None</span>
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="6" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>By using <code>boundary</code> and <code>break</code> it is possible to implement data types to handle errors &quot;directly&quot; with a short exit path more easily than with monads.</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">aggregate</span></span>(xs: <span class="hljs-type">List</span>[<span class="hljs-type">Uri</span>]): <span class="hljs-type">Either</span>[<span class="hljs-type">Error</span>, <span class="hljs-type">List</span>[<span class="hljs-type">Response</span>]] = 
  either: <span class="hljs-comment">// boundary</span>
    xs.map(doRequest(_).?) <span class="hljs-comment">// `?` break if `doRequest` returns a `Left`, otherwise unwrap the `Right`</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">doRequest</span></span>(endpoint: <span class="hljs-type">Uri</span>): <span class="hljs-type">Either</span>[<span class="hljs-type">Error</span>, <span class="hljs-type">Response</span>] =
  <span class="hljs-type">HttpClientSyncBackend</span>().send(basicRequest.get(endpoint)).body
</code></pre>
<div class="cols">
<div>
<p>Using monadic style:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">aggregate</span></span>(xs: <span class="hljs-type">List</span>[<span class="hljs-type">Uri</span>]): <span class="hljs-type">Either</span>[<span class="hljs-type">Error</span>, <span class="hljs-type">List</span>[<span class="hljs-type">Response</span>]] =
    xs.foldLeft[<span class="hljs-type">Either</span>[<span class="hljs-type">String</span>, <span class="hljs-type">List</span>[<span class="hljs-type">String</span>]]](<span class="hljs-type">Right</span>(<span class="hljs-type">List</span>.empty)): 
      (acc, uri) =&gt;
        <span class="hljs-keyword">for</span>
          results &lt;- acc
          response &lt;- doRequest(uri)
        <span class="hljs-keyword">yield</span> results :+ response
</code></pre>
</div>
<div>
<p>Could be simplified using Cats <code>traverse</code>, yet there remains considerable complexity behind it...</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">aggregate</span></span>(xs: <span class="hljs-type">List</span>[<span class="hljs-type">Uri</span>]): <span class="hljs-type">Either</span>[<span class="hljs-type">Error</span>, <span class="hljs-type">List</span>[<span class="hljs-type">Response</span>]] =
    <span class="hljs-keyword">import</span> cats.implicits.toTraverseOps
    <span class="hljs-comment">// &quot;Given a function which returns a G effect, thread </span>
    <span class="hljs-comment">// this effect through the running of this function on </span>
    <span class="hljs-comment">// all the values in F, returning an F[B] in a G context.&quot;</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">//    def traverse[G[_]: Applicative, A, B](</span>
    <span class="hljs-comment">//      fa: F[A]</span>
    <span class="hljs-comment">//    )(f: A =&gt; G[B]): G[F[B]]</span>
    xs.traverse(doRequest)
</code></pre>
</div>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="7" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>Functions requiring the <code>CanFail</code> type can promptly break the computation upon encountering an error. On the calling side, the label is defined using the <code>either</code> boundary.</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">CanFail</span> </span>= <span class="hljs-type">Label</span>[<span class="hljs-type">Left</span>[<span class="hljs-type">String</span>, <span class="hljs-type">Nothing</span>]]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUser</span></span>(id: <span class="hljs-type">UserId</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">User</span> =
    <span class="hljs-keyword">val</span> user = userBy(id)
    <span class="hljs-keyword">if</span> verifyUser(user) <span class="hljs-keyword">then</span> user <span class="hljs-keyword">else</span> fail(<span class="hljs-string">&quot;Incorrect user&quot;</span>)
    <span class="hljs-comment">// `fail` is a shorthand for `break(Left(&quot;Incorrect user&quot;))`</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPayment</span></span>(user: <span class="hljs-type">User</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">PaymentMethod</span> =
  paymentMethodOf(user) <span class="hljs-keyword">match</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">Some</span>(a) <span class="hljs-keyword">if</span> verifyMethod(a) =&gt; a
    <span class="hljs-keyword">case</span> <span class="hljs-type">Some</span>(_) =&gt; fail(<span class="hljs-string">&quot;The payment method is not valid&quot;</span>)
    <span class="hljs-keyword">case</span> _ =&gt; fail(<span class="hljs-string">&quot;Missing payment method&quot;</span>)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">paymentData</span></span>(id: <span class="hljs-type">UserId</span>) = either:
  <span class="hljs-keyword">val</span> user = getUser(id)
  <span class="hljs-keyword">val</span> address = getPayment(user)
  (user, address)
</code></pre>
<p>This is a simple example of <em>effect</em> management in direct style, where the <em>effect</em> is the possibility of <em>failure</em>.</p>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="8" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="modeling-effects-with-capabilities">Modeling effects with capabilities</h3>
<p><a href="https://abgruszecki.github.io/publication/capturing-types/capturing-types.pdf">CAPabilities for RESources and Effects (CAPRESE) ↗</a> is the ongoing research project at the Programming Methods Laboratory @ EPFL whose goal is to <em>upgrade</em> the <em>Scala type system</em> to <em>track effects</em> directly in the program, without pushing them into external (monadic) frameworks.</p>
<p><em>Idea</em>:</p>
<ul>
<li>to have an <em><strong>effect</strong></em> you need the <em><strong>capability</strong></em> enabling it;</li>
<li>a capability is just a <strong>value</strong> passed to the function performing the effect, usually <em>implicitly</em>.</li>
</ul>
<p>For example, <code>CanFail</code> is the capability enabling the effect of breaking in case of errors:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span></span>(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">Int</span> = ...
</code></pre>
<p>Marking a function with <code>CanFail</code> explicitly indicates that the function may fail and must be called in a context where the <code>CanFail</code> capability is available. If the function is called without the capability, the compiler will raise an error.</p>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="9" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p><strong>The <code>CanFail</code> capability</strong></p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-comment">/** The CAPABILITY enabling to break the computation 
  * returning a [[Left]] with an useful string-encoded message.
  */</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">CanFail</span> </span>= <span class="hljs-type">Label</span>[<span class="hljs-type">Left</span>[<span class="hljs-type">String</span>, <span class="hljs-type">Nothing</span>]]

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">either</span></span>:

  <span class="hljs-comment">/** Defines the boundary for the [[Either]] returning computation, whose [[body]] is given in input. */</span>
  <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span></span>[<span class="hljs-type">L</span>, <span class="hljs-type">R</span>](<span class="hljs-keyword">inline</span> body: <span class="hljs-type">Label</span>[<span class="hljs-type">Left</span>[<span class="hljs-type">L</span>, <span class="hljs-type">Nothing</span>]] ?=&gt; <span class="hljs-type">R</span>): <span class="hljs-type">Either</span>[<span class="hljs-type">L</span>, <span class="hljs-type">R</span>] =
    boundary(<span class="hljs-type">Right</span>(body))

  <span class="hljs-comment">/** Quickly break to the enclosing boundary with a [[Left]] filled with [[l]]. 
    * This is the EFFECT.
    */</span>
  <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fail</span></span>[<span class="hljs-type">L</span>, <span class="hljs-type">R</span>](l: <span class="hljs-type">L</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Label</span>[<span class="hljs-type">Left</span>[<span class="hljs-type">L</span>, <span class="hljs-type">R</span>]]): <span class="hljs-type">Nothing</span> = <span class="hljs-keyword">break</span>(<span class="hljs-type">Left</span>(l))

  <span class="hljs-keyword">extension</span> [<span class="hljs-type">L</span>, <span class="hljs-type">R</span>](e: <span class="hljs-type">Either</span>[<span class="hljs-type">L</span>, <span class="hljs-type">R</span>])
    <span class="hljs-comment">/** @return this [[Right]] value or break to the enclosing boundary with the [[Left]] value. 
      * This is the EFFECT.
      */</span>
    <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">?</span></span>(<span class="hljs-keyword">using</span> <span class="hljs-type">Label</span>[<span class="hljs-type">Left</span>[<span class="hljs-type">L</span>, <span class="hljs-type">Nothing</span>]]): <span class="hljs-type">R</span> = e <span class="hljs-keyword">match</span>
      <span class="hljs-keyword">case</span> <span class="hljs-type">Right</span>(value) =&gt; value
      <span class="hljs-keyword">case</span> <span class="hljs-type">Left</span>(value) =&gt; <span class="hljs-keyword">break</span>(<span class="hljs-type">Left</span>(value))
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="10" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>Similarly to <code>CanFail</code>, the <strong><code>CanThrow</code> capability</strong> is available as an <em>experimental</em> feature to manage in an effectful way the possibility of throwing exceptions.</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-comment">// CanThrow capability is an experimental feature and can be enabled with the following import</span>
<span class="hljs-keyword">import</span> language.experimental.saferExceptions

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DivisionByZero</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span></span>

<span class="hljs-comment">// Or equivalently:</span>
<span class="hljs-comment">// def div(n: Int, m: Int): Int throws DivisionByZero</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">div</span></span>(n: <span class="hljs-type">Int</span>, m: <span class="hljs-type">Int</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanThrow</span>[<span class="hljs-type">DivisionByZero</span>]): <span class="hljs-type">Int</span> = m <span class="hljs-keyword">match</span>
  <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-type">DivisionByZero</span>() <span class="hljs-comment">// the effect</span>
  <span class="hljs-keyword">case</span> _ =&gt; n / m

<span class="hljs-keyword">try</span>
  <span class="hljs-comment">// the compiler makes available the CanThrow capability as given instance inside the try block</span>
  div(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>)
<span class="hljs-keyword">catch</span> <span class="hljs-keyword">case</span> _: <span class="hljs-type">DivisionByZero</span> =&gt; <span class="hljs-string">&quot;Division by zero&quot;</span>

<span class="hljs-comment">// If you attempt to call `div` outside the `try` block, the compiler will raise an error</span>
div(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>)
<span class="hljs-comment">//      ^^^</span>
<span class="hljs-comment">// Error: The capability to throw exception is missing.</span>
</code></pre>
<p>The <code>CanThrow</code> capability behaves similarly to Java checked exceptions, but it is more flexible, allowing them to be thrown in higher-order functions.</p>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="11" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h4 id="the-suspension-effect">The suspension effect</h4>
<p>As part of the CAPRESE project, the <a href="https://github.com/lampepfl/gears">Gears ↗</a> library has been developed with the goal of providing support for <em>asynchronous programming</em>, leveraging capabilities to model, in direct style the <strong>suspension</strong> effect.</p>
<p><img src="./res/cap-hierarchy.svg" alt="" style="height:300px;" /></p>
<ul>
<li>
<p><code>Async</code> is the capability allowing a computation to suspend while waiting for the result of an asynchronous source.</p>
</li>
<li>
<p><code>Async.Spawn</code> is a special subtype of <code>Async</code> (<code>Async.Spawn &lt;: Async</code>) that allows to spawn a new concurrent asynchronous computation.</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 1000 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g></g></g></svg></mjx-container> <strong>Capabilities form a hierarchical structure.</strong></p>
</li>
</ul>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="12" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>You can get the <code>Async</code> and <code>Async.Spawn</code> capabilities via:</p>
<ul>
<li><code>Async.blocking</code>
<ul>
<li>is the root capability generator;</li>
<li>it executes asynchronous computation <code>body</code> on currently running thread. The thread will suspend when the computation waits;</li>
<li>usually placed inside the <code>main</code> or for testing purposes;</li>
</ul>
</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">blocking</span></span>[<span class="hljs-type">T</span>](body: <span class="hljs-type">Async</span>.<span class="hljs-type">Spawn</span> ?=&gt; <span class="hljs-type">T</span>): <span class="hljs-type">T</span>
</code></pre>
<ul>
<li><code>Async.group</code>: runs <code>body</code> inside a spawnable context where it is allowed to spawn concurrently runnable Futures. It requires an implicit <code>Async</code> instance to be in scope;</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">group</span></span>[<span class="hljs-type">T</span>](body: <span class="hljs-type">Async</span>.<span class="hljs-type">Spawn</span> ?=&gt; <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>): <span class="hljs-type">T</span>
</code></pre>
<p>Gears supports both JVM and Native platforms: on the JVM, it is built on top of Virtual Threads, and on Scala Native, it leverages delimited continuations.</p>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="13" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>Example: a service allowing storing posts, performing checks on the content and author before the actual storage performed concurrently.</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-comment">/** The repository in charge of storing and retrieving blog posts. */</span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">PostsRepository</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save</span></span>(post: <span class="hljs-type">Post</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Post</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exists</span></span>(postTitle: <span class="hljs-type">Title</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Boolean</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load</span></span>(postTitle: <span class="hljs-type">Title</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Option</span>[<span class="hljs-type">Post</span>]

<span class="hljs-comment">/** The service exposing a set of functionalities to interact with blog posts. */</span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">PostsService</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create</span></span>(authorId: <span class="hljs-type">AuthorId</span>, title: <span class="hljs-type">Title</span>, body: <span class="hljs-type">Body</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Post</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span></span>(title: <span class="hljs-type">Title</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Option</span>[<span class="hljs-type">Post</span>]
</code></pre>
<ul>
<li>
<p><code>Async</code> capability allows methods to suspend while waiting for the result;</p>
</li>
<li>
<p><code>CanFail</code> capability allows methods to break the computation returning an error message in case of failure.</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 1000 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g></g></g></svg></mjx-container> <strong>Composing effects with capabilities is straightforward</strong>: just add the required capabilities to the method signature.</p>
</li>
</ul>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="14" data-marpit-fragments="3" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="14" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<div class="smaller">
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostsServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PostsService</span></span>:

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create</span></span>(authorId: <span class="hljs-type">AuthorId</span>, title: <span class="hljs-type">Title</span>, body: <span class="hljs-type">Body</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Post</span> =
    <span class="hljs-keyword">if</span> context.repository.exists(title) <span class="hljs-keyword">then</span> fail(<span class="hljs-string">s&quot;A post entitled <span class="hljs-subst">$title</span> already exists&quot;</span>)
    <span class="hljs-keyword">val</span> (post, author) = <span class="hljs-type">Async</span>.group:
      <span class="hljs-keyword">val</span> content = <span class="hljs-type">Future</span>(verifyContent(title, body))
      <span class="hljs-keyword">val</span> author = <span class="hljs-type">Future</span>(authorBy(authorId))
      content.zip(author).awaitResult.?
    context.repository.save(<span class="hljs-type">Post</span>(author, post._1, post._2, <span class="hljs-type">Date</span>()))

  <span class="hljs-comment">/* Pretending to make a call to the Authorship Service that keeps track of authorized authors. */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authorBy</span></span>(id: <span class="hljs-type">AuthorId</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>): <span class="hljs-type">Author</span> = ...

  <span class="hljs-comment">/* Some local computation that verifies the content of the post is appropriate. */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verifyContent</span></span>(title: <span class="hljs-type">Title</span>, body: <span class="hljs-type">Body</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">Async</span>): <span class="hljs-type">PostContent</span> = ...
</code></pre>
<ul>
<li data-marpit-fragment="1"><code>authorBy</code> and <code>verifyContent</code> are executed concurrently - the concurrent execution is explicit opted-in by using a Gears <code>Future</code>;</li>
<li data-marpit-fragment="2"><strong>Structured concurrency model</strong>: every <code>Async</code> context has a completion group tracking all computations in a tree structure guaranteeing that when a group terminates all its dangling children are canceled.</li>
<li data-marpit-fragment="3"><code>Future</code>s can be <em>composed</em> and <em>awaited</em> for their result;
<ul>
<li><code>zip</code> operator allows combining the results of two <code>Future</code>s in a pair if both succeed, or fail with the first error encountered. Combined with <code>Async.group</code> the failure of one determines the cancellation of the other because the cancellation group is shared and once the <code>zip</code> completes the group is terminated.</li>
</ul>
</li>
</ul>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="15" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>A comparison</p>
<table>
<thead>
<tr>
<th style="text-align:left">Feature</th>
<th style="text-align:left">Gears Futures</th>
<th style="text-align:left">Scala monadic Futures</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Structured concurrency</td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="✅" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" data-marp-twemoji=""/></td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="❌" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" data-marp-twemoji=""/></td>
</tr>
<tr>
<td style="text-align:left">Cancellation support</td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="✅" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" data-marp-twemoji=""/></td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="❌" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" data-marp-twemoji=""/></td>
</tr>
<tr>
<td style="text-align:left">Referential transparency</td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="⚠" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" data-marp-twemoji=""/> <code>Future</code>'s aren't, but <code>Task</code>s are delayed referential transparent <code>Future</code>s.</td>
<td style="text-align:left"><img class="emoji" draggable="false" alt="❌" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" data-marp-twemoji=""/> Once declared, they are spawned.</td>
</tr>
<tr>
<td style="text-align:left">Concurrency model</td>
<td style="text-align:left">By default the code is serial. If you want to opt-in concurrency you have to explicitly use a Future or Task.</td>
<td style="text-align:left">By default, the code is concurrent.</td>
</tr>
</tbody>
</table>
<p>Other notable features of Gears (here not covered):</p>
<ul>
<li>other composition operators, like <code>or</code>, <code>orWithCancel</code>, <code>awaitAll</code>;</li>
<li><code>Channel</code>s for communication between concurrent computations;</li>
</ul>
<div class="smaller">
<p>You can find a detailed insight and some examples <a href="https://tassiluca.github.io/direct-style-experiments/">here ↗</a>.</p>
</div>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="16" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h4 id="capabilities-leakage-problem">Capabilities leakage problem</h4>
<p><code>IO</code> capability to manage input/output operations:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-comment">/** The capability enabling writing and reading from a source. */</span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">IO</span></span>:
  <span class="hljs-comment">/** IO Write effect operation. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span></span>(content: <span class="hljs-type">String</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">Unit</span>
  <span class="hljs-comment">/** IO read effect operation. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span></span>[<span class="hljs-type">T</span>](f: <span class="hljs-type">Iterator</span>[<span class="hljs-type">String</span>] =&gt; <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">T</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">IO</span></span>:

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span></span>(x: <span class="hljs-type">String</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">IO</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">Unit</span> = summon[<span class="hljs-type">IO</span>].write(x)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span></span>[<span class="hljs-type">T</span>](f: <span class="hljs-type">Iterator</span>[<span class="hljs-type">String</span>] =&gt; <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">IO</span>, <span class="hljs-type">CanFail</span>): <span class="hljs-type">T</span> = summon[<span class="hljs-type">IO</span>].read(f)

  <span class="hljs-comment">/** File IO capability generator. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">file</span></span>[<span class="hljs-type">R</span>](path: <span class="hljs-type">Path</span>)(body: <span class="hljs-type">IO</span> ?=&gt; <span class="hljs-type">R</span>): <span class="hljs-type">Runnable</span>[<span class="hljs-type">R</span>] = () =&gt;
    <span class="hljs-keyword">given</span> <span class="hljs-type">IO</span> <span class="hljs-keyword">with</span> <span class="hljs-comment">// effect handler</span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span></span>(content: <span class="hljs-type">String</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">Unit</span> =
        <span class="hljs-type">Using</span>(<span class="hljs-type">PrintWriter</span>(path.toFile)): writer =&gt;
          writer.write(content)
        .?
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span></span>[<span class="hljs-type">T</span>](f: <span class="hljs-type">Iterator</span>[<span class="hljs-type">String</span>] =&gt; <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">T</span> =
        <span class="hljs-type">Using</span>(<span class="hljs-type">Source</span>.fromFile(path.toFile)): source =&gt;
          f(source.getLines())
        .?
    body
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="17" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p><strong>Problem</strong>:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-meta">@main</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">breakingIO</span> </span>= either:
  <span class="hljs-keyword">val</span> path = <span class="hljs-type">Path</span>.of(<span class="hljs-string">&quot;test.txt&quot;</span>)
  <span class="hljs-comment">// The file lines are returned as an iterator; no lines are read at this point...</span>
  <span class="hljs-keyword">val</span> eff: <span class="hljs-type">Runnable</span>[<span class="hljs-type">Iterator</span>[<span class="hljs-type">String</span>]] = <span class="hljs-type">IO</span>.file(path):
    read(identity)
  <span class="hljs-comment">// ...when we try to execute the effect, the lines are read but the stream is already closed!</span>
  <span class="hljs-keyword">val</span> content = eff.run().next() <span class="hljs-comment">// throws &quot;IOException: Stream Already Closed&quot;!!!</span>
  println(content)
</code></pre>
<ul>
<li>the <code>IO.file</code> body returns an <code>Iterator[String]</code> that is lazily evaluated
<ul>
<li><em>Consequence</em>: the lines are read only after the file has been closed, which results in an <code>IOException</code> being thrown;</li>
<li>the same happens if, for example, a lambda is returned, as shown here:<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-type">IO</span>.file(path):
  read(() =&gt; _.mkString)
</code></pre>
</li>
</ul>
</li>
<li><strong>No compilation error</strong> is raised, the error is raised only at runtime!</li>
</ul>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="18" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="capture-checking">Capture checking</h3>
<p>To solve this issue <code>IO</code> needs to be marked as a <em>capability</em> and the return type of the <code>file</code> method must keep track of the capability lifetime by using a <strong>capturing type</strong> of the form:</p>
<p><code>T^{cap1, cap2, ..., capN}</code></p>
<p>where <code>T</code> is a regular type and <code>{cap1, cap2, ..., capN}</code> is called <strong>capture set</strong> and it represents the set of capabilities that the type <code>T</code> can capture or reference.</p>
<ul>
<li>if the capture set is empty the type is <strong>pure</strong>, otherwise it is considered <strong>impure</strong>;</li>
<li><code>cap</code> is the <strong>universal capability</strong> which is the most sweeping capability from which all other capabilities are derived. <code>T^{cap}</code> can be abbreviated as <code>T^</code>.;</li>
<li>When a class <code>C</code> extends the <code>Capability</code> trait, it is the same as if the type of <code>C</code> is <code>C^{cap}</code></li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-keyword">import</span> scala.language.experimental.captureChecking

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">IO</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Capability</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span></span>(content: <span class="hljs-type">String</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">Unit</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span></span>[<span class="hljs-type">T</span>](f: <span class="hljs-type">Iterator</span>[<span class="hljs-type">String</span>]^ =&gt; <span class="hljs-type">T</span>)(<span class="hljs-keyword">using</span> <span class="hljs-type">CanFail</span>): <span class="hljs-type">T</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">IO</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">file</span></span>[<span class="hljs-type">R</span>](path: <span class="hljs-type">Path</span>)(body: <span class="hljs-type">IO</span> ?=&gt; <span class="hljs-type">R</span>): <span class="hljs-type">Runnable</span>[<span class="hljs-type">R</span>]^{body} = <span class="hljs-comment">/* same as before */</span>
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="19" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<p>Now, the compiler recognizes the leakage of the capabilities outside the intended scope and raises an error:</p>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-scala"><span class="hljs-meta">@main</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">breakingIO</span> </span>= either:
  <span class="hljs-keyword">val</span> path = <span class="hljs-type">Path</span>.of(<span class="hljs-string">&quot;test.txt&quot;</span>)
  <span class="hljs-keyword">val</span> eff = <span class="hljs-type">IO</span>.file(path):
    write(<span class="hljs-string">&quot;Hello, World from IO capability!&quot;</span>) <span class="hljs-comment">// ok!</span>
    read(_.mkString) <span class="hljs-comment">// ok!</span>

    read(l =&gt; l) <span class="hljs-comment">//, or equivalently: read(identity)</span>
    <span class="hljs-comment">// ^^^^^^^^^</span>
    <span class="hljs-comment">// local reference l leaks into outer capture set of type parameter T of method read in object IO</span>

    () =&gt; write(<span class="hljs-string">&quot;Hello, World from IO capability!&quot;</span>)
    <span class="hljs-comment">// ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
    <span class="hljs-comment">// local reference IO leaks into outer capture set of type parameter R of method file in object IO</span>
  <span class="hljs-keyword">val</span> content = eff.run()
</code></pre>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="20" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="recap">Recap</h3>
<ul>
<li>Direct style frameworks are simpler to use and reason about than monadic style;</li>
<li>It is possible to manage effects in direct style using <strong>capabilities</strong>, like <code>CanFail</code>, <code>CanThrow</code>, <code>IO</code>, <code>Async</code>, etc;
<ul>
<li>Gears is an experimental library that allows to model the suspension effect in direct style providing continuation-based structured concurrency;</li>
</ul>
</li>
<li><strong>Capture checking</strong> is needed to ensure that the capabilities are not leaked outside the scope where they are intended to be used.
<ul>
<li>Type system will distinguish between <em>pure</em> and <em>impure</em> types, where impure types can capture capabilities, while pure types cannot.</li>
<li>Currently, capture checking has been already applied to parts of the Standard Library and the Scala 3 compiler. The Caprese project is working to extend this feature to the whole Scala 3 ecosystem.</li>
</ul>
</li>
</ul>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-footer="Scala 3 Direct Style Effect Management" data-paginate="true" data-theme="uncover" data-style="h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
" lang="en-US" data-marpit-pagination="21" style="--footer:Scala 3 Direct Style Effect Management;--paginate:true;--theme:uncover;--style:h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; }
h3 { font-size: 1.1rem; margin-bottom: 0.2em; }
h4 { font-size: 0.9rem; margin-bottom: 0.2em; }
p { 
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
ul, ol {
  margin-left: 1em;
}
li {
  margin-bottom: 0.5em;
  font-size: 0.6rem;
  line-height: 1.2;
  letter-spacing: 0.02em;
}
strong {
  color: #0366D6;
}
h1 em {
  color: #4fca6c;
}
em {
  color: #36ab51;
}
code {
  font-size: 0.65em;
}
a {
  color: #0366D6;
  text-decoration: none;
}
.columns {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem;
  align-items: center;
}
.columns img {
  width: 100%;
  height: auto;
}
.full-image {
  display: flex;
  justify-content: center;
  align-items: center;
  height: calc(100% - 50px);
}
.full-image img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
}
.cols {
  display: flex;
  gap: 16px;
}
.cols &gt; div {
  flex: 1;
  padding: 0 10px;
  border-right: 1px solid #ccc;
}
.cols &gt; div:last-child {
  border-right: none;
}
.smaller li, .smaller p, .smaller code, .smaller pre {
  font-size: 0.5rem !important;
}
.center-list ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  width: fit-content;
}
.center-list li {
  text-align: center;
}
table {
  font-size: 0.6rem;
  letter-spacing: 0.02em;
  border-collapse: collapse;
  width: 100%;
}
;" data-marpit-pagination-total="21">
<h3 id="code-examples">Code examples</h3>
<p>All the code examples shown in this presentation (and more) are available <a href="https://github.com/tassiluca/direct-style-effects">here ↗</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://arxiv.org/abs/2207.03402">Martin Odersky, Aleksander Boruch-Gruszecki, Edward Lee, Jonathan Brachthäuser, Ondřej Lhoták, Scoped Capabilities for Polymorphic Effects ↗</a></li>
<li><a href="https://github.com/lampepfl/gears">Gears project library ↗</a></li>
<li><a href="https://dotty.epfl.ch/docs/reference/experimental/cc.html">Capture checking ↗</a></li>
<li><a href="https://dotty.epfl.ch/docs/reference/experimental/canthrow.html"><code>CanThrow</code> capability ↗</a></li>
<li><a href="https://tassiluca.github.io/direct-style-experiments/">More experiments in Gears are available here ↗</a></li>
</ul>
<footer>Scala 3 Direct Style Effect Management</footer>
</section>
<script>!function(){"use strict";const t={h1:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"1"},style:"display: block; font-size: 2em; margin-block-start: 0.67em; margin-block-end: 0.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h2:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"2"},style:"display: block; font-size: 1.5em; margin-block-start: 0.83em; margin-block-end: 0.83em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h3:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"3"},style:"display: block; font-size: 1.17em; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h4:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"4"},style:"display: block; margin-block-start: 1.33em; margin-block-end: 1.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h5:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"5"},style:"display: block; font-size: 0.83em; margin-block-start: 1.67em; margin-block-end: 1.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h6:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"6"},style:"display: block; font-size: 0.67em; margin-block-start: 2.33em; margin-block-end: 2.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},span:{proto:()=>HTMLSpanElement},pre:{proto:()=>HTMLElement,style:"display: block; font-family: monospace; white-space: pre; margin: 1em 0; --marp-auto-scaling-white-space: pre;"}},e="data-marp-auto-scaling-wrapper",i="data-marp-auto-scaling-svg",n="data-marp-auto-scaling-container";class s extends HTMLElement{container;containerSize;containerObserver;svg;svgComputedStyle;svgPreserveAspectRatio="xMinYMid meet";wrapper;wrapperSize;wrapperObserver;constructor(){super();const t=t=>([e])=>{const{width:i,height:n}=e.contentRect;this[t]={width:i,height:n},this.updateSVGRect()};this.attachShadow({mode:"open"}),this.containerObserver=new ResizeObserver(t("containerSize")),this.wrapperObserver=new ResizeObserver(((...e)=>{t("wrapperSize")(...e),this.flushSvgDisplay()}))}static get observedAttributes(){return["data-downscale-only"]}connectedCallback(){this.shadowRoot.innerHTML=`\n<style>\n  svg[${i}] { display: block; width: 100%; height: auto; vertical-align: top; }\n  span[${n}] { display: table; white-space: var(--marp-auto-scaling-white-space, nowrap); width: max-content; }\n</style>\n<div ${e}>\n  <svg part="svg" ${i}>\n    <foreignObject><span ${n}><slot></slot></span></foreignObject>\n  </svg>\n</div>\n    `.split(/\n\s*/).join(""),this.wrapper=this.shadowRoot.querySelector(`div[${e}]`)??void 0;const t=this.svg;this.svg=this.wrapper?.querySelector(`svg[${i}]`)??void 0,this.svg!==t&&(this.svgComputedStyle=this.svg?window.getComputedStyle(this.svg):void 0),this.container=this.svg?.querySelector(`span[${n}]`)??void 0,this.observe()}disconnectedCallback(){this.svg=void 0,this.svgComputedStyle=void 0,this.wrapper=void 0,this.container=void 0,this.observe()}attributeChangedCallback(){this.observe()}flushSvgDisplay(){const{svg:t}=this;t&&(t.style.display="inline",requestAnimationFrame((()=>{t.style.display=""})))}observe(){this.containerObserver.disconnect(),this.wrapperObserver.disconnect(),this.wrapper&&this.wrapperObserver.observe(this.wrapper),this.container&&this.containerObserver.observe(this.container),this.svgComputedStyle&&this.observeSVGStyle(this.svgComputedStyle)}observeSVGStyle(t){const e=()=>{const i=(()=>{const e=t.getPropertyValue("--preserve-aspect-ratio");if(e)return e.trim();return`x${(({textAlign:t,direction:e})=>{if(t.endsWith("left"))return"Min";if(t.endsWith("right"))return"Max";if("start"===t||"end"===t){let i="rtl"===e;return"end"===t&&(i=!i),i?"Max":"Min"}return"Mid"})(t)}YMid meet`})();i!==this.svgPreserveAspectRatio&&(this.svgPreserveAspectRatio=i,this.updateSVGRect()),t===this.svgComputedStyle&&requestAnimationFrame(e)};e()}updateSVGRect(){let t=Math.ceil(this.containerSize?.width??0);const e=Math.ceil(this.containerSize?.height??0);void 0!==this.dataset.downscaleOnly&&(t=Math.max(t,this.wrapperSize?.width??0));const i=this.svg?.querySelector(":scope > foreignObject");if(i?.setAttribute("width",`${t}`),i?.setAttribute("height",`${e}`),this.svg&&(this.svg.setAttribute("viewBox",`0 0 ${t} ${e}`),this.svg.setAttribute("preserveAspectRatio",this.svgPreserveAspectRatio),this.svg.style.height=t<=0||e<=0?"0":""),this.container){const t=this.svgPreserveAspectRatio.toLowerCase();this.container.style.marginLeft=t.startsWith("xmid")||t.startsWith("xmax")?"auto":"0",this.container.style.marginRight=t.startsWith("xmi")?"auto":"0"}}}const r=(t,{attrs:e={},style:i})=>class extends t{constructor(...t){super(...t);for(const[t,i]of Object.entries(e))this.hasAttribute(t)||this.setAttribute(t,i);this._shadow()}static get observedAttributes(){return["data-auto-scaling"]}connectedCallback(){this._update()}attributeChangedCallback(){this._update()}_shadow(){if(!this.shadowRoot)try{this.attachShadow({mode:"open"})}catch(t){if(!(t instanceof Error&&"NotSupportedError"===t.name))throw t}return this.shadowRoot}_update(){const t=this._shadow();if(t){const e=i?`<style>:host { ${i} }</style>`:"";let n="<slot></slot>";const{autoScaling:s}=this.dataset;if(void 0!==s){n=`<marp-auto-scaling exportparts="svg:auto-scaling" ${"downscale-only"===s?"data-downscale-only":""}>${n}</marp-auto-scaling>`}t.innerHTML=e+n}}};let o;const a=Symbol();let l;const c="marpitSVGPolyfill:setZoomFactor,",d=Symbol(),h=Symbol();const g=()=>{const t="Apple Computer, Inc."===navigator.vendor,e=t?[u]:[],i={then:e=>(t?(async()=>{if(void 0===l){const t=document.createElement("canvas");t.width=10,t.height=10;const e=t.getContext("2d"),i=new Image(10,10),n=new Promise((t=>{i.addEventListener("load",(()=>t()))}));i.crossOrigin="anonymous",i.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%2210%22%20viewBox%3D%220%200%201%201%22%3E%3CforeignObject%20width%3D%221%22%20height%3D%221%22%20requiredExtensions%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3E%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22width%3A%201px%3B%20height%3A%201px%3B%20background%3A%20red%3B%20position%3A%20relative%22%3E%3C%2Fdiv%3E%3C%2FforeignObject%3E%3C%2Fsvg%3E",await n,e.drawImage(i,0,0),l=e.getImageData(5,5,1,1).data[3]<128}return l})().then((t=>{null==e||e(t?[u]:[])})):null==e||e([]),i)};return Object.assign(e,i)};let p,m;function u(t){const e="object"==typeof t&&t.target||document,i="object"==typeof t?t.zoom:t;window[h]||(Object.defineProperty(window,h,{configurable:!0,value:!0}),document.body.style.zoom=1.0001,document.body.offsetHeight,document.body.style.zoom=1,window.addEventListener("message",(({data:t,origin:e})=>{if(e===window.origin)try{if(t&&"string"==typeof t&&t.startsWith(c)){const[,e]=t.split(","),i=Number.parseFloat(e);Number.isNaN(i)||(m=i)}}catch(t){console.error(t)}})));let n=!1;Array.from(e.querySelectorAll("svg[data-marpit-svg]"),(t=>{var e,s,r,o;t.style.transform||(t.style.transform="translateZ(0)");const a=i||m||t.currentScale||1;p!==a&&(p=a,n=a);const l=t.getBoundingClientRect(),{length:c}=t.children;for(let i=0;i<c;i+=1){const n=t.children[i];if(n.getScreenCTM){const t=n.getScreenCTM();if(t){const i=null!==(s=null===(e=n.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==s?s:0,c=null!==(o=null===(r=n.y)||void 0===r?void 0:r.baseVal.value)&&void 0!==o?o:0,d=n.children.length;for(let e=0;e<d;e+=1){const s=n.children[e];if("SECTION"===s.tagName){const{style:e}=s;e.transformOrigin||(e.transformOrigin=`${-i}px ${-c}px`),e.transform=`scale(${a}) matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.e-l.left}, ${t.f-l.top}) translateZ(0.0001px)`;break}}}}}})),!1!==n&&Array.from(e.querySelectorAll("iframe"),(({contentWindow:t})=>{null==t||t.postMessage(`${c}${n}`,"null"===window.origin?"*":window.origin)}))}function v({once:t=!1,target:e=document}={}){const i=function(t=document){if(t[d])return t[d];let e=!0;const i=()=>{e=!1,delete t[d]};Object.defineProperty(t,d,{configurable:!0,value:i});let n=[],s=!1;(async()=>{try{n=await g()}finally{s=!0}})();const r=()=>{for(const e of n)e({target:t});s&&0===n.length||e&&window.requestAnimationFrame(r)};return r(),i}(e);return t?(i(),()=>{}):i}p=1,m=void 0;const w=Symbol(),b=(e=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(((e=document)=>{const i=window[a];i||customElements.define("marp-auto-scaling",s);for(const n of Object.keys(t)){const s=`marp-${n}`,a=t[n].proto();(o??(o=!!document.createElement("div",{is:"marp-auto-scaling"}).outerHTML.startsWith("<div is"),o))&&a!==HTMLElement?i||customElements.define(s,r(a,{style:t[n].style}),{extends:n}):(i||customElements.define(s,r(HTMLElement,t[n])),e.querySelectorAll(`${n}[is="${s}"]`).forEach((t=>{t.outerHTML=t.outerHTML.replace(new RegExp(`^<${n}`,"i"),`<${s}`).replace(new RegExp(`</${n}>$`,"i"),`</${s}>`)})))}window[a]=!0})(e),e[w])return e[w];const i=v({target:e}),n=()=>{i(),delete e[w]},l=Object.assign(n,{cleanup:n,update:()=>b(e)});return Object.defineProperty(e,w,{configurable:!0,value:l}),l},y=document.currentScript;b(y?y.getRootNode():document)}();
</script></foreignObject></svg></div><div class="bespoke-marp-note" data-index="17" tabindex="0"><p>The idea to solve this issue is that the Scala type system needs to be updated to keep track of capabilities lifetime and this is done by what is called **capture checking**, which is essentially a new phase of the scala type checker that
leverage on new capturing types to catch the leakage of capabilities.

A capturing type is of the form...</p></div><script>/*!! License: https://unpkg.com/@marp-team/marp-cli@4.1.2/lib/bespoke.js.LICENSE.txt */
!function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,n,r=(n||(n=1,t={from:function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),o=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),a={},i=function(e,t){return(t=t||{}).index=o.indexOf(e),t.slide=e,t},s=function(e,t){a[e]=(a[e]||[]).filter((function(e){return e!==t}))},c=function(e,t){return(a[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},l=function(e,t){o[e]&&(n&&c("deactivate",i(n,t)),n=o[e],c("activate",i(n,t)))},d=function(e,t){var r=o.indexOf(n)+e;c(e>0?"next":"prev",i(n,t))&&l(r,t)},u={off:s,on:function(e,t){return(a[e]||(a[e]=[])).push(t),s.bind(null,e,t)},fire:c,slide:function(e,t){if(!arguments.length)return o.indexOf(n);c("slide",i(o[e],t))&&l(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:o,destroy:function(e){c("destroy",i(n,e)),a={}}};return(t||[]).forEach((function(e){e(u)})),n||l(0),u}}),t),o=e(r);const a=document.body,i=(...e)=>history.replaceState(...e),s="",c="presenter",l="next",d=["",c,l],u="bespoke-marp-",f=`data-${u}`,m=(e,{protocol:t,host:n,pathname:r,hash:o}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${o}`},g=()=>a.dataset.bespokeView,p=e=>new URLSearchParams(location.search).get(e),v=(e,t={})=>{const n={location,setter:i,...t},r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter({...window.history.state??{}},"",m(r,n.location))}catch(e){console.error(e)}},h=(()=>{const e="bespoke-marp";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}})(),y=e=>{try{return localStorage.getItem(e)}catch{return null}},b=(e,t)=>{try{return localStorage.setItem(e,t),!0}catch{return!1}},w=e=>{try{return localStorage.removeItem(e),!0}catch{return!1}},x=(e,t)=>{const n="aria-hidden";t?e.setAttribute(n,"true"):e.removeAttribute(n)},k=e=>{e.parent.classList.add(`${u}parent`),e.slides.forEach((e=>e.classList.add(`${u}slide`))),e.on("activate",(t=>{const n=`${u}active`,r=t.slide,o=r.classList,a=!o.contains(n);if(e.slides.forEach((e=>{e.classList.remove(n),x(e,!0)})),o.add(n),x(r,!1),a){const e=`${n}-ready`;o.add(e),document.body.clientHeight,o.remove(e)}}))},$=e=>{let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],o=(r,o)=>{t=r,n=o,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const a=t<r||t===r&&n<=o;e.setAttribute(`${f}fragment`,(a?"":"in")+"active");const i=`${f}current-fragment`;t===r&&n===o?e.setAttribute(i,"current"):e.removeAttribute(i)}))})),e.fragmentIndex=o;const a={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:o};e.fire("fragment",a)};e.on("next",(({fragment:a=!0})=>{if(a){if(r(1))return o(t,n+1),!1;const a=t+1;e.fragments[a]&&o(a,0)}else{const r=e.fragments[t].length;if(n+1<r)return o(t,r-1),!1;const a=e.fragments[t+1];a&&o(t+1,a.length-1)}})),e.on("prev",(({fragment:a=!0})=>{if(r(-1)&&a)return o(t,n-1),!1;const i=t-1;e.fragments[i]&&o(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const o=e.fragments[t];if(o){const{length:e}=o;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}o(t,r)})),o(0,0)},E=document,L=()=>!(!E.fullscreenEnabled&&!E.webkitFullscreenEnabled),S=()=>!(!E.fullscreenElement&&!E.webkitFullscreenElement),P=e=>{e.fullscreen=()=>{L()&&(async()=>{S()?(E.exitFullscreen||E.webkitExitFullscreen)?.call(E):((e=E.body)=>{(e.requestFullscreen||e.webkitRequestFullscreen)?.call(e)})()})()},document.addEventListener("keydown",(t=>{"f"!==t.key&&"F11"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!L()||(e.fullscreen(),t.preventDefault())}))},_=`${u}inactive`,T=(e=2e3)=>({parent:t,fire:n})=>{const r=t.classList,o=e=>n(`marp-${e?"":"in"}active`);let a;const i=()=>{a&&clearTimeout(a),a=setTimeout((()=>{r.add(_),o()}),e),r.contains(_)&&(r.remove(_),o(!0))};for(const e of["mousedown","mousemove","touchend"])document.addEventListener(e,i);setTimeout(i,0)},I=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"],M=e=>{e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(I.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))},O=e=>{window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("marp-auto-scaling, [data-auto-scaling], [data-marp-fitting]");t.setAttribute(`${f}load`,e?"":"hideable")}}))},A=({interval:e=250}={})=>t=>{document.addEventListener("keydown",(e=>{if(" "===e.key&&e.shiftKey)t.prev();else if("ArrowLeft"===e.key||"ArrowUp"===e.key||"PageUp"===e.key)t.prev({fragment:!e.shiftKey});else if(" "!==e.key||e.shiftKey)if("ArrowRight"===e.key||"ArrowDown"===e.key||"PageDown"===e.key)t.next({fragment:!e.shiftKey});else if("End"===e.key)t.slide(t.slides.length-1,{fragment:-1});else{if("Home"!==e.key)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,o=0;t.parent.addEventListener("wheel",(a=>{let i=!1;const s=(e,t)=>{e&&(i=i||((e,t)=>((e,t)=>{const n="X"===t?"Width":"Height";return e[`client${n}`]<e[`scroll${n}`]})(e,t)&&((e,t)=>{const{overflow:n}=e,r=e[`overflow${t}`];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r})(getComputedStyle(e),t))(e,t)),e?.parentElement&&s(e.parentElement,t)};if(0!==a.deltaX&&s(a.target,"X"),0!==a.deltaY&&s(a.target,"Y"),i)return;a.preventDefault();const c=Math.sqrt(a.deltaX**2+a.deltaY**2);if(void 0!==a.wheelDelta){if(void 0===a.webkitForce&&Math.abs(a.wheelDelta)<40)return;if(a.deltaMode===a.DOM_DELTA_PIXEL&&c<4)return}else if(a.deltaMode===a.DOM_DELTA_PIXEL&&c<12)return;r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const l=Date.now()-o<e,d=c<=n;if(n=c,l||d)return;let u;(a.deltaX>0||a.deltaY>0)&&(u="next"),(a.deltaX<0||a.deltaY<0)&&(u="prev"),u&&(t[u](),o=Date.now())}))},C=(e=`.${u}osc`)=>{const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[${f}osc=${JSON.stringify(e)}]`).forEach(n)};return L()||n("fullscreen",(e=>e.style.display="none")),h||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;n&&t.target.blur();const r={fragment:!t.shiftKey};"next"===n?e.next(r):"prev"===n?e.prev(r):"fullscreen"===n?e?.fullscreen():"presenter"===n&&e.openPresenterView()}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:o})=>{n("prev",(e=>e.disabled=0===t&&0===o)),n("next",(n=>n.disabled=t===e.slides.length-1&&o===r.length-1))})),e.on("marp-active",(()=>x(t,!1))),e.on("marp-inactive",(()=>x(t,!0))),L()&&(e=>{for(const t of["","webkit"])E.addEventListener(t+"fullscreenchange",e)})((()=>n("fullscreen",(e=>e.classList.toggle("exit",L()&&S())))))}},D=e=>{window.addEventListener("message",(t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let o=Number.parseInt(t,10),a=Number.parseInt(n,10)+1;a>=e.fragments[o].length&&(o+=1,a=0),e.slide(o,{fragment:a})}}))};var N,B,q,K,j,F,V,U={exports:{}},X=(N||(N=1,U.exports=(B=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],q=function(e){return String(e).replace(/[&<>"']/g,(function(e){return"&"+K[e]+";"}))},K={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},j="dangerouslySetInnerHTML",F={className:"class",htmlFor:"for"},V={},function(e,t){var n=[],r="";t=t||{};for(var o=arguments.length;o-- >2;)n.push(arguments[o]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(var a in t)!1!==t[a]&&null!=t[a]&&a!==j&&(r+=" "+(F[a]?F[a]:q(a))+'="'+q(t[a])+'"');r+=">"}if(-1===B.indexOf(e)){if(t[j])r+=t[j].__html;else for(;n.length;){var i=n.pop();if(i)if(i.pop)for(var s=i.length;s--;)n.push(i[s]);else r+=!0===V[i]?i:q(i)}r+=e?"</"+e+">":""}return V[r]=!0,r})),U.exports),H=e(X);const R=({children:e})=>H(null,null,...e),W=`${u}presenter-`,J={container:`${W}container`,dragbar:`${W}dragbar-container`,next:`${W}next`,nextContainer:`${W}next-container`,noteContainer:`${W}note-container`,noteWrapper:`${W}note-wrapper`,noteButtons:`${W}note-buttons`,infoContainer:`${W}info-container`,infoPage:`${W}info-page`,infoPageText:`${W}info-page-text`,infoPagePrev:`${W}info-page-prev`,infoPageNext:`${W}info-page-next`,noteButtonsBigger:`${W}note-bigger`,noteButtonsSmaller:`${W}note-smaller`,infoTime:`${W}info-time`,infoTimer:`${W}info-timer`},Y=e=>{const{title:t}=document;document.title="[Presenter view]"+(t?` - ${t}`:"");const n={},r=e=>(n[e]=n[e]||document.querySelector(`.${e}`),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=J.container,t.appendChild(e),t.insertAdjacentHTML("beforeend",H(R,null,H("div",{class:J.nextContainer},H("iframe",{class:J.next,src:"?view=next"})),H("div",{class:J.dragbar}),H("div",{class:J.noteContainer},H("div",{class:J.noteWrapper}),H("div",{class:J.noteButtons},H("button",{class:J.noteButtonsSmaller,tabindex:"-1",title:"Smaller notes font size"},"Smaller notes font size"),H("button",{class:J.noteButtonsBigger,tabindex:"-1",title:"Bigger notes font size"},"Bigger notes font size"))),H("div",{class:J.infoContainer},H("div",{class:J.infoPage},H("button",{class:J.infoPagePrev,tabindex:"-1",title:"Previous"},"Previous"),H("span",{class:J.infoPageText}),H("button",{class:J.infoPageNext,tabindex:"-1",title:"Next"},"Next")),H("time",{class:J.infoTime,title:"Current time"}),H("time",{class:J.infoTimer,title:"Timer"})))),t})(e.parent)),(e=>{let t=!1;r(J.dragbar).addEventListener("mousedown",(()=>{t=!0,r(J.dragbar).classList.add("active")})),window.addEventListener("mouseup",(()=>{t=!1,r(J.dragbar).classList.remove("active")})),window.addEventListener("mousemove",(e=>{if(!t)return;const n=e.clientX/document.documentElement.clientWidth*100;r(J.container).style.setProperty("--bespoke-marp-presenter-split-ratio",`${Math.max(0,Math.min(100,n))}%`)})),r(J.nextContainer).addEventListener("click",(()=>e.next()));const n=r(J.next),o=(a=n,(e,t)=>a.contentWindow?.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin));var a;n.addEventListener("load",(()=>{r(J.nextContainer).classList.add("active"),o(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>o(e,t)))}));const i=document.querySelectorAll(".bespoke-marp-note");i.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(J.noteWrapper).appendChild(e)})),e.on("activate",(()=>i.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide())))));let s=0;const c=e=>{s=Math.max(-5,s+e),r(J.noteContainer).style.setProperty("--bespoke-marp-note-font-scale",(1.2**s).toFixed(4))},l=()=>c(1),d=()=>c(-1),u=r(J.noteButtonsBigger),f=r(J.noteButtonsSmaller);u.addEventListener("click",(()=>{u.blur(),l()})),f.addEventListener("click",(()=>{f.blur(),d()})),document.addEventListener("keydown",(e=>{"+"===e.key&&l(),"-"===e.key&&d()}),!0),e.on("activate",(({index:t})=>{r(J.infoPageText).textContent=`${t+1} / ${e.slides.length}`}));const m=r(J.infoPagePrev),g=r(J.infoPageNext);m.addEventListener("click",(t=>{m.blur(),e.prev({fragment:!t.shiftKey})})),g.addEventListener("click",(t=>{g.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{m.disabled=0===t&&0===r,g.disabled=t===e.slides.length-1&&r===n.length-1}));let p=new Date;const v=()=>{const e=new Date,t=e=>`${Math.floor(e)}`.padStart(2,"0"),n=e.getTime()-p.getTime(),o=t(n/1e3%60),a=t(n/1e3/60%60),i=t(n/36e5%24);r(J.infoTime).textContent=e.toLocaleTimeString(),r(J.infoTimer).textContent=`${i}:${a}:${o}`};v(),setInterval(v,250),r(J.infoTimer).addEventListener("click",(()=>{p=new Date}))})(e)},z=e=>{if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:G},presenterUrl:{enumerable:!0,get:Q}}),h&&document.addEventListener("keydown",(t=>{"p"!==t.key||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))};function G(){const{max:e,floor:t}=Math,n=e(t(.85*window.innerWidth),640),r=e(t(.85*window.innerHeight),360);return window.open(this.presenterUrl,W+this.syncKey,`width=${n},height=${r},menubar=no,toolbar=no`)}function Q(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),m(e)}const Z=e=>{const t=g();return t===l&&e.appendChild(document.createElement("span")),{[s]:z,[c]:Y,[l]:D}[t]},ee=e=>{e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-parent > .bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))},te=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t},ne=(e={})=>{const t={history:!0,...e};return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},o=(t={fragment:!0})=>{let n=t.fragment?te(p("f")||""):null;((t,n)=>{const{min:r,max:o}=Math,{fragments:a,slides:i}=e,s=o(0,r(t,i.length-1)),c=o(0,r(n||0,a[s].length-1));s===e.slide()&&c===e.fragmentIndex||e.slide(s,{fragment:c})})((()=>{if(location.hash){const[t]=location.hash.slice(1).split(":~:");if(/^\d+$/.test(t))return(te(t)??1)-1;const r=document.getElementById(t)||document.querySelector(`a[name="${CSS.escape(t)}"]`);if(r){const{length:t}=e.slides;for(let o=0;o<t;o+=1)if(e.slides[o].contains(r)){const t=e.fragments?.[o],a=r.closest("[data-marpit-fragment]");if(t&&a){const e=t.indexOf(a);e>=0&&(n=e)}return o}}}return 0})(),n)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||v({f:0===r||r.toString()},{location:{...location,hash:`#${e+1}`},setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{o(),window.addEventListener("hashchange",(()=>r((()=>{o({fragment:!1}),v({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>o()))})),n=!1}),0)}},re=(e={})=>{const t=e.key||window.history.state?.marpBespokeSyncKey||Math.random().toString(36).slice(2),n=`bespoke-marp-sync-${t}`;var r;r={marpBespokeSyncKey:t},v({},{setter:(e,...t)=>i({...e,...r},...t)});const o=()=>{const e=y(n);return e?JSON.parse(e):Object.create(null)},a=e=>{const t=o(),r={...t,...e(t)};return b(n,JSON.stringify(r)),r},s=()=>{window.removeEventListener("pageshow",s),a((e=>({reference:(e.reference||0)+1})))};return e=>{s(),Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let r=!0;setTimeout((()=>{e.on("fragment",(e=>{r&&a((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),o=JSON.parse(t.newValue);if(n.index!==o.index||n.fragmentIndex!==o.fragmentIndex)try{r=!1,e.slide(o.index,{fragment:o.fragmentIndex,forSync:!0})}finally{r=!0}}}));const i=()=>{const{reference:e}=o();void 0===e||e<=1?w(n):a((()=>({reference:e-1})))};window.addEventListener("pagehide",(e=>{e.persisted&&window.addEventListener("pageshow",s),i()})),e.on("destroy",i)}},{PI:oe,abs:ae,sqrt:ie,atan2:se}=Math,ce={passive:!0},le=({slope:e=-.7,swipeThreshold:t=30}={})=>n=>{let r;const o=n.parent,a=e=>{const t=o.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};o.addEventListener("touchstart",(({touches:e})=>{r=1===e.length?a(e[0]):void 0}),ce),o.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=a(e.touches[0]),n=t.x-r.x,o=t.y-r.y;r.delta=ie(ae(n)**2+ae(o)**2),r.radian=se(n,o)}else r=void 0})),o.addEventListener("touchend",(o=>{if(r){if(r.delta&&r.delta>=t&&r.radian){const t=(r.radian-e+oe)%(2*oe)-oe;n[t<0?"next":"prev"](),o.stopPropagation()}r=void 0}}),ce)},de=new Map;de.clear(),de.set("none",{backward:{both:void 0,incoming:void 0,outgoing:void 0},forward:{both:void 0,incoming:void 0,outgoing:void 0}});const ue={both:"",outgoing:"outgoing-",incoming:"incoming-"},fe={forward:"",backward:"-backward"},me=e=>`--marp-bespoke-transition-animation-${e}`,ge=e=>`--marp-transition-${e}`,pe=me("name"),ve=me("duration"),he=e=>new Promise((t=>{const n={},r=document.createElement("div"),o=e=>{r.remove(),t(e)};r.addEventListener("animationstart",(()=>o(n))),Object.assign(r.style,{animationName:e,animationDuration:"1s",animationFillMode:"both",animationPlayState:"paused",position:"absolute",pointerEvents:"none"}),document.body.appendChild(r);const a=getComputedStyle(r).getPropertyValue(ge("duration"));a&&(n.defaultDuration=a),((e,t)=>{requestAnimationFrame((()=>{e.style.animationPlayState="running",requestAnimationFrame((()=>t(void 0)))}))})(r,o)})),ye=async e=>de.has(e)?de.get(e):(e=>{const t={},n=[];for(const[r,o]of Object.entries(ue))for(const[a,i]of Object.entries(fe)){const s=`marp-${o}transition${i}-${e}`;n.push(he(s).then((e=>{t[a]=t[a]||{},t[a][r]=e?{...e,name:s}:void 0})))}return Promise.all(n).then((()=>t))})(e).then((t=>(de.set(e,t),t))),be=e=>Object.values(e).flatMap(Object.values).every((e=>!e)),we=(e,{type:t,backward:n})=>{const r=e[n?"backward":"forward"],o=(()=>{const e=r[t],n=e=>({[pe]:e.name});if(e)return n(e);if(r.both){const e=n(r.both);return"incoming"===t&&(e[me("direction")]="reverse"),e}})();return!o&&n?we(e,{type:t,backward:!1}):o||{[pe]:"__bespoke_marp_transition_no_animation__"}},xe=e=>{if(e)try{const t=JSON.parse(e);if((e=>{if("object"!=typeof e)return!1;const t=e;return"string"==typeof t.name&&(void 0===t.duration||"string"==typeof t.duration)})(t))return t}catch{}},ke="_tSId",$e="_tA",Ee="bespoke-marp-transition-warming-up",Le=window.matchMedia("(prefers-reduced-motion: reduce)"),Se="__bespoke_marp_transition_reduced_outgoing__",Pe="__bespoke_marp_transition_reduced_incoming__",_e={forward:{both:void 0,incoming:{name:Pe},outgoing:{name:Se}},backward:{both:void 0,incoming:{name:Pe},outgoing:{name:Se}}},Te=e=>{if(!document.startViewTransition)return;const t=t=>(void 0!==t&&(e._tD=t),e._tD);let n;t(!1),((...e)=>{const t=[...new Set(e).values()];return Promise.all(t.map((e=>ye(e)))).then()})(...Array.from(document.querySelectorAll("section[data-transition], section[data-transition-back]")).flatMap((e=>[e.dataset.transition,e.dataset.transitionBack].flatMap((e=>{const t=xe(e);return[t?.name,t?.builtinFallback?`__builtin__${t.name}`:void 0]})).filter((e=>!!e))))).then((()=>{document.querySelectorAll("style").forEach((e=>{e.innerHTML=e.innerHTML.replace(/--marp-transition-duration:[^;}]*[;}]/g,(e=>e.slice(0,-1)+"!important"+e.slice(-1)))}))}));const r=(n,{back:r,cond:o})=>a=>{const i=t();if(i)return!!a[$e]||!("object"!=typeof i||(i.skipTransition(),!a.forSync));if(!o(a))return!0;const s=e.slides[e.slide()],c=()=>a.back??r,l="data-transition"+(c()?"-back":""),d=s.querySelector(`section[${l}]`);if(!d)return!0;const u=xe(d.getAttribute(l)??void 0);return!u||((async(e,{builtinFallback:t=!0}={})=>{let n=await ye(e);if(be(n)){if(!t)return;return n=await ye(`__builtin__${e}`),be(n)?void 0:n}return n})(u.name,{builtinFallback:u.builtinFallback}).then((e=>{if(!e){t(!0);try{n(a)}finally{t(!1)}return}let r=e;Le.matches&&(console.warn("Use a constant animation to transition because preferring reduced motion by viewer has detected."),r=_e);const o=document.getElementById(ke);o&&o.remove();const i=document.createElement("style");i.id=ke,document.head.appendChild(i),((e,t)=>{const n=[`:root{${ge("direction")}:${t.backward?-1:1};}`,":root:has(.bespoke-marp-inactive){cursor:none;}"],r=t=>{const n=e[t].both?.defaultDuration||e[t].outgoing?.defaultDuration||e[t].incoming?.defaultDuration;return"forward"===t?n:n||r("forward")},o=t.duration||r(t.backward?"backward":"forward");void 0!==o&&n.push(`::view-transition-group(*){${ve}:${o};}`);const a=e=>Object.entries(e).map((([e,t])=>`${e}:${t};`)).join("");return n.push(`::view-transition-old(root){${a(we(e,{...t,type:"outgoing"}))}}`,`::view-transition-new(root){${a(we(e,{...t,type:"incoming"}))}}`),n})(r,{backward:c(),duration:u.duration}).forEach((e=>i.sheet?.insertRule(e)));const s=document.documentElement.classList;s.add(Ee);let l=!1;const d=()=>{l||(n(a),l=!0,s.remove(Ee))},f=()=>{t(!1),i.remove(),s.remove(Ee)};try{t(!0);const e=document.startViewTransition(d);t(e),e.finished.finally(f)}catch(e){console.error(e),d(),f()}})),!1)};e.on("prev",r((t=>e.prev({...t,[$e]:!0})),{back:!0,cond:e=>e.index>0&&!((e.fragment??1)&&n.fragmentIndex>0)})),e.on("next",r((t=>e.next({...t,[$e]:!0})),{cond:t=>t.index+1<e.slides.length&&!(n.fragmentIndex+1<n.fragments.length)})),setTimeout((()=>{e.on("slide",r((t=>e.slide(t.index,{...t,[$e]:!0})),{cond:t=>{const n=e.slide();return t.index!==n&&(t.back=t.index<n,!0)}}))}),0),e.on("fragment",(e=>{n=e}))};let Ie;const Me=()=>(void 0===Ie&&(Ie="wakeLock"in navigator&&navigator.wakeLock),Ie),Oe=async()=>{const e=Me();if(e)try{return await e.request("screen")}catch(e){console.warn(e)}return null},Ae=async()=>{if(!Me())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&Oe()};for(const e of["visibilitychange","fullscreenchange"])document.addEventListener(e,t);return e=await Oe(),e};((e=document.getElementById(":$p"))=>{(()=>{const e=p("view");a.dataset.bespokeView=e===l||e===c?e:""})();const t=(e=>{const t=p(e);return v({[e]:void 0}),t})("sync")||void 0;o.from(e,((...e)=>{const t=d.findIndex((e=>g()===e));return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[1,1,0],re({key:t})],[[1,1,1],Z(e)],[[1,1,0],M],[[1,1,1],k],[[1,0,0],T()],[[1,1,1],O],[[1,1,1],ne({history:!1})],[[1,1,0],A()],[[1,1,0],P],[[1,0,0],ee],[[1,1,0],le()],[[1,0,0],C()],[[1,0,0],Te],[[1,1,1],$],[[1,1,0],Ae]))})()}();</script></body></html>